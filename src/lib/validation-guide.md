# Система валидации с Zod

## Обзор
Мы внедрили современную систему валидации форм с использованием библиотеки Zod, которая обеспечивает типобезопасность и удобную обработку ошибок.

## Основные компоненты

### 1. Схемы валидации (`src/lib/validation.ts`)
- `productSchema` - основная схема для валидации продуктов
- `productFormSchema` - схема для данных формы с преобразованием строк в числа
- `measurementUnitSchema` - схема для единиц измерения
- Функции валидации с детальными ошибками

### 2. Custom Hook (`src/hooks/useProductForm.ts`)
- Управление состоянием формы
- Автоматическая валидация с debounce
- Управление единицами измерения
- Отслеживание изменений и валидности

### 3. UI компоненты
- `FormField.tsx` - универсальные поля формы с ошибками
- `FormInput.tsx` - input с встроенной валидацией
- `FormSelect.tsx` - select с валидацией
- `ValidationSummary.tsx` - сводка по ошибкам валидации

## Возможности валидации

### Продукты
- ✅ Проверка обязательных полей
- ✅ Валидация типов данных
- ✅ Ограничения диапазонов (калории 0-2000, БЖУ 0-100)
- ✅ Проверка существования категории
- ✅ Кастомное правило: сумма БЖУ ≤ 110г
- ✅ Точность до 0.1 для всех числовых значений

### Единицы измерения
- ✅ Валидация типа единицы
- ✅ Проверка веса (0.1г - 10кг)
- ✅ Валидация названия
- ✅ Ограничение количества (до 10 единиц)

### UX улучшения
- ✅ Валидация в реальном времени с debounce
- ✅ Отключение кнопки сохранения при ошибках
- ✅ Визуальная индикация состояния формы
- ✅ Детальные сообщения об ошибках на русском языке
- ✅ Accessibility поддержка (aria-labels, aria-invalid)

## Использование

```typescript
// В компоненте
const {
  formData,
  errors,
  isValid,
  isDirty,
  updateField,
  validateForm,
  resetForm
} = useProductForm(initialData);

// Валидация отдельных значений
const result = validateProduct(productData);
if (result.success) {
  console.log('Валидные данные:', result.data);
} else {
  console.log('Ошибки:', result.errors);
}
```

## Преимущества

1. **Типобезопасность** - автоматическая генерация TypeScript типов
2. **Производительность** - валидация только при изменениях
3. **UX** - мгновенная обратная связь для пользователя
4. **Поддержка** - подробные сообщения об ошибках
5. **Расширяемость** - легко добавлять новые правила валидации
6. **Консистентность** - единая система валидации для всего приложения

## Интеграция

Система полностью интегрирована в `ProductModal` и готова для использования в других формах приложения. Достаточно импортировать нужные компоненты и хуки.
